Arden — DTO System
Архив состояния секторов и чанков

Статус: Draft
Цель: определить минимальный стандарт упаковки и восстановления данных мира.

1. Назначение

DTO (Data Transfer Object) в Arden — это компактный снимок состояния части мира, пригодный для:

выгрузки из оперативной памяти,

быстрого восстановления в активную симуляцию,

хранения промежуточных состояний между сессиями.

2. Объекты архивирования

Сектор внимания (группа окточанков).

Отдельный окточанк 32×32×32 (для точечной оптимизации).

Метаданные сектора: состояние, версия формата, контрольная сумма.

3. Минимальный состав DTO

Заголовок: версия формата, тип объекта (Sector|Octochunk), размер, хэш.

Данные вокселей: плотность/заполненность, идентификатор материала.

Индексы LOD: выбранный уровень, карта активных подпоясов.

Локальные теги/флаги: “грязный” чанк, время последней модификации.

Опционально: сжатые данные для быстрой передачи/диска.

4. Операции

Save: сериализация сектора/чанка в DTO.

Load: восстановление в оперативную структуру.

Validate: проверка версии и целостности (хэш).

Upgrade: миграция DTO при смене версии формата.

5. Политика использования

DTO не “думает”, он хранит. Решения о когда/что архивировать принимает HAOS.

rDTO (опционально) может локально инициировать Save/Load в ограниченной зоне ответственности, если это разрешено политикой HAOS.

6. Требования к производительности

Ограничение времени сериализации на кадр.

Пакетная обработка DTO с приоритетами.

Фоновая компрессия вне главного потока рендера (при наличии).

7. Контроль версий

Семантическая версия DTO-формата: MAJOR.MINOR.PATCH.

Правило совместимости: MINOR и PATCH обязаны быть обратно совместимы; MAJOR допускает миграцию.
